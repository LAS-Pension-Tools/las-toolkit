function itemRow(it){
  const row=document.createElement('div');
  row.className='row';
  row.dataset.id=it.id;

  const name=document.createElement('input');
  name.className='cs4';
  name.value=it.label;
  name.setAttribute('aria-label','Pay item name');
  name.addEventListener('input',()=>{it.label=name.value; render();});

  const wrap=document.createElement('div');
  wrap.className='cs3';
  wrap.style.display='flex';
  wrap.style.alignItems='center';
  wrap.style.gap='8px';
  const chk=document.createElement('input');
  chk.type='checkbox';
  chk.checked=!!it.useRate;
  chk.setAttribute('aria-label','Use rate times hours');
  const lbl=document.createElement('span');
  lbl.className='small';
  lbl.textContent='rate × hours';
  wrap.append(chk,lbl);

  const rate=document.createElement('input');
  rate.type='number';
  rate.placeholder='rate';
  rate.className='cs2';
  rate.step='0.01';
  rate.min='0';
  rate.value=it.rate ?? '';
  rate.setAttribute('aria-label','Hourly rate');

  const hours=document.createElement('input');
  hours.type='number';
  hours.placeholder='hours';
  hours.className='cs2';
  hours.step='0.01';
  hours.min='0';
  hours.value=it.hours ?? '';
  hours.setAttribute('aria-label','Hours worked');

  const amount=document.createElement('input');
  amount.type='number';
  amount.className='cs6';
  amount.step='0.01';
  amount.min='0';
  amount.value=it.amount;
  amount.setAttribute('aria-label','Total amount (£)');

  const preview=document.createElement('div');
  preview.className='cs1 small';
  preview.style.textAlign='right';
  preview.style.opacity='.7';

  const remove=document.createElement('button');
  remove.className='cs1 btn';
  remove.textContent='×';
  remove.type='button';
  remove.setAttribute('aria-label','Remove pay item');
  remove.addEventListener('click',()=>{
    state.items=state.items.filter(x=>x.id!==it.id);
    render();
  });

  function toggle(){
    if(chk.checked){
      rate.classList.remove('hide');
      hours.classList.remove('hide');
      amount.classList.add('hide');
      preview.textContent=fmt((it.rate||0)*(it.hours||0));
      it.useRate=true;
    } else {
      rate.classList.add('hide');
      hours.classList.add('hide');
      amount.classList.remove('hide');
      preview.textContent='';
      it.useRate=false;
    }
  }

  chk.addEventListener('change',()=>{toggle(); render();});
  toggle();

  rate.addEventListener('input',()=>{it.rate=parseFloat(rate.value||'0'); render();});
  hours.addEventListener('input',()=>{it.hours=parseFloat(hours.value||'0'); render();});
  amount.addEventListener('input',()=>{it.amount=parseFloat(amount.value||'0'); render();});

  row.append(name,wrap,rate,hours,amount,preview,remove);
  return row;
}
